<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RC Flight Weather</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 12px;
    background: #f4f6f8;
  }

  .card {
    background: #ffffff;
    border-radius: 10px;
    padding: 14px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    max-width: 420px;
  }

  h3 {
    margin-top: 0;
    margin-bottom: 8px;
  }

  .row {
    margin-bottom: 6px;
  }

  .label {
    color: #555;
    font-size: 0.9em;
  }

  .value {
    font-weight: bold;
  }

  .status {
    padding: 8px;
    border-radius: 6px;
    text-align: center;
    font-weight: bold;
    margin-top: 10px;
  }

  .good { background: #d4edda; color: #155724; }
  .marginal { background: #fff3cd; color: #856404; }
  .poor { background: #f8d7da; color: #721c24; }

  iframe {
    border: none;
    border-radius: 8px;
    margin-top: 10px;
    width: 100%;
    height: 180px;
  }
</style>
</head>

<body>
<div class="card">
  <h3>‚úàÔ∏è RC Flight Weather</h3>
  <div id="weather">Loading weather...</div>

  <!-- Map -->
<iframe
  src="https://embed.windy.com/embed2.html?lat=41.9925&lon=-79.9928&detailLat=41.9925&detailLon=-79.9928&width=100%&height=250&zoom=11&level=surface&overlay=wind&product=ecmwf&menu=&message=true&marker=true&calendar=now&pressure=&type=map&location=coordinates&detail=true&metricWind=mph&metricTemp=¬∞F"
  style="width:100%; height:250px; border-radius:8px; margin-top:10px;"
  loading="lazy">
</iframe>

</div>

<script>
async function loadWeather() {
  const pointUrl = "https://api.weather.gov/points/41.9925,-79.9928";
  const pointResp = await fetch(pointUrl);
  const pointData = await pointResp.json();

  const forecastUrl = pointData.properties.forecastHourly;
  const forecastResp = await fetch(forecastUrl);
  const forecastData = await forecastResp.json();

  const current = forecastData.properties.periods[0];

  const windSpeed = parseInt(current.windSpeed);
  const gusts = current.windGust ? parseInt(current.windGust) : null;

  let statusClass = "good";
  let statusText = "üü¢ Good flying conditions";

  if (windSpeed > 12 || (gusts && gusts > 18)) {
    statusClass = "poor";
    statusText = "üî¥ Poor ‚Äì Not recommended";
  } else if (windSpeed > 8 || (gusts && gusts > 12)) {
    statusClass = "marginal";
    statusText = "üü° Marginal ‚Äì Experienced pilots";
  }

  document.getElementById("weather").innerHTML = `
    <div class="row">
      <span class="label">Wind:</span>
      <span class="value">${current.windSpeed} ${current.windDirection}</span>
    </div>
    <div class="row">
      <span class="label">Gusts:</span>
      <span class="value">${current.windGust || "N/A"}</span>
    </div>
    <div class="row">
      <span class="label">Temperature:</span>
      <span class="value">${current.temperature}¬∞${current.temperatureUnit}</span>
    </div>
    <div class="row">
      <span class="label">Forecast:</span>
      <span class="value">${current.shortForecast}</span>
    </div>

    <div class="status ${statusClass}">
      ${statusText}
    </div>
  `;
}

loadWeather();
setInterval(loadWeather, 10 * 60 * 1000);
</script>
</body>
</html>
