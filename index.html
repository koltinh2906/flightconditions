<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RC Flight Weather</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 12px;
    background: #f4f6f8;
  }

.card {
  background: #ffffff;
  border-radius: 10px;
  padding: 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.12);
  max-width: 100%; /* allow full width on mobile */
  width: 420px;    /* default width on desktop */
  margin: auto;
}

  h3 {
    margin-top: 0;
    margin-bottom: 8px;
  }

  .row {
    margin-bottom: 6px;
  }

  .label {
    color: #555;
    font-size: 0.9em;
  }

  .value {
    font-weight: bold;
  }

  .status {
    padding: 8px;
    border-radius: 6px;
    text-align: center;
    font-weight: bold;
    margin-top: 10px;
  }

  .good { background: #d4edda; color: #155724; }
  .marginal { background: #fff3cd; color: #856404; }
  .poor { background: #f8d7da; color: #721c24; }

 .hourly {
  display: flex;
  flex-wrap: wrap; /* wrap hourly blocks instead of scrolling */
  gap: 6px;
  margin-top: 10px;
  justify-content: center;
}

.hour {
  min-width: 60px;
  flex: 1 0 auto;
}

  .hour.good { background: #d4edda; color: #155724; }
  .hour.marginal { background: #fff3cd; color: #856404; }
  .hour.poor { background: #f8d7da; color: #721c24; }
</style>
</head>

<body>
<div class="card">
  <h3>‚úàÔ∏è RC Flight Weather</h3>
  <div id="weather">Loading weather...</div>
  <div id="hourly"></div>
</div>

<script>
async function loadWeather() {
  const lat = 41.9925;
  const lon = -79.9928;
  const pointUrl = `https://api.weather.gov/points/${lat},${lon}`;
  const pointResp = await fetch(pointUrl);
  const pointData = await pointResp.json();

  const forecastUrl = pointData.properties.forecastHourly;
  const forecastResp = await fetch(forecastUrl);
  const forecastData = await forecastResp.json();

  const periods = forecastData.properties.periods;
  const current = periods[0];

  const windSpeed = parseInt(current.windSpeed);
  const gusts = current.windGust ? parseInt(current.windGust) : null;

  let statusClass = "good";
  let statusText = "üü¢ Good flying conditions";

  if (windSpeed > 12 || (gusts && gusts > 18)) {
    statusClass = "poor";
    statusText = "üî¥ Poor ‚Äì Not recommended";
  } else if (windSpeed > 8 || (gusts && gusts > 12)) {
    statusClass = "marginal";
    statusText = "üü° Marginal ‚Äì Experienced pilots";
  }

  // Update current weather card
  document.getElementById("weather").innerHTML = `
    <div class="row"><span class="label">Wind:</span> <span class="value">${current.windSpeed} ${current.windDirection}</span></div>
    <div class="row"><span class="label">Gusts:</span> <span class="value">${current.windGust || "N/A"}</span></div>
    <div class="row"><span class="label">Temp:</span> <span class="value">${current.temperature}¬∞${current.temperatureUnit}</span></div>
    <div class="row"><span class="label">Forecast:</span> <span class="value">${current.shortForecast}</span></div>
    <div class="status ${statusClass}">${statusText}</div>
  `;

  // Hourly recommendations (next 6 hours)
  let hourlyHTML = `<h4 style="margin-top:10px;">‚è± Hourly Flight Recommendation</h4><div class="hourly">`;

  periods.slice(0, 6).forEach(p => {
    const hour = new Date(p.startTime).getHours();
    const wind = parseInt(p.windSpeed);
    const gust = p.windGust ? parseInt(p.windGust) : null;

    let cls = "good";
    let label = "Fly";

    if (wind > 12 || (gust && gust > 18)) {
      cls = "poor";
      label = "No Fly";
    } else if (wind > 8 || (gust && gust > 12)) {
      cls = "marginal";
      label = "Marginal";
    }

    hourlyHTML += `
      <div class="hour ${cls}">
        <div><strong>${hour}:00</strong></div>
        <div>${label}</div>
      </div>
    `;
  });

  hourlyHTML += `</div>`;
  document.getElementById("hourly").innerHTML = hourlyHTML;
}

loadWeather();
setInterval(loadWeather, 10 * 60 * 1000); // refresh every 10 min
</script>
</body>
</html>
